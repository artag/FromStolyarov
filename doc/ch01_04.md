# 1.4. Программы и данные

## 1.4.1. Об измерении количества информации

Любая информация в компьюетере представляется 1 и 0.

Наименьшей единицей информации является **бит** (bit - BInary digiT).

Бит - это количество информации, которое уменьшает неопределенность вдвое.

**Байт** (byte) - 8 бит.

1 байт может принять 256 возможных значений:

- от 0 до 255
- от -128 до 127

Шина адресов, состоящая из `N` дорожек позволяет различать `2^N` адресов
(предельное количество ячеек).

Память состоит из *банков*, каждый из которых состоит из ячеек.

1024 = 2^10 ячеек - килобайт

*Машинное слово* - размер порции данных, обрабатываемых процессором
за одну операцию обычно совападает с размером ячейки.

Единицы измерения больших объемов информации:

- килобайт
- мегабайт
- гигабайт
- терабайт
- петабайт

Новые приставки, означающие степени числа 1024:

| Приставки | Обозначение | Значение | Примечание        |
|-----------|-------------|----------|-------------------|
|           | `b`         | 1 бит    |                   |
|           | `B`         | 1 байт   |                   |
| *киби-*   | `Ki`        | (2^10)   | (от kilo, binary) |
| *меби-*   | `Mi`        | (2^20)   |                   |
| *гиби-*   | `Gi`        | (2^30)   |                   |
| *теби-*   | `Ti`        | (2^40)   |                   |
| *пеби-*   | `Pi`        | (2^50)   |                   |
| *эксби-*  | `Ei`        | (2^60)   |                   |
| *зеби-*   | `Zi`        | (2^70)   |                   |
| *йоби-*   | `Yi`        | (2^80)   |                   |

Пример: 1 Gib - гибибайт (2^30 байт), 1 Mibit - мебибит (2^20 бит)

## 1.4.2. Машинное представление целых чисел

Для целых положительных чисел позиционной несмешанной системы счисления
по основанию `N` числом разрядов `k` максимальное число составляет

```text
N^k - 1
```

Пример:

максимальное число в восьмибитной ячейке: `2^8 - 1 = 255`

### Порядок следования байтов (2 вида)

1. **little-endian**. Первым идет младший байт числа. *Самый популярный сейчас*.

2. **big-endian**. Первым идет старший байт числа.

Пример:

Число `1D4C` представлено в 4 ячейках памяти так:

- При big-endian: `00 00 1D 4C`
- При little-endian: `4C 1D 00 00`

### Дополнительный код

*Англ. two's complement - двоичное дополнение*

Дополнительный код позволяет отобразить отрицательные целые числа.

1. **Отрицательными** считаются комбинации, старший бит которых равен **1**,
остальные комбинации считаются неотрицательными.

2. Чтобы **сменить знак числа** на противоположный надо инвертировать все разряды
и прибавить `1`.

Пример:

```text
75 - 19
+75 это 01001011
+19 это 00010011
-19 это 11101100 + 1
      = 11101101

75-19   01001011
      + 11101101
      = 00111000

Ответ: 00111000 или 56
```

## 1.4.3. Числа с плавающей точкой

Для числа с плавающей запятой отдельно хранятся:

- **мантисса** `M` (двоичная дробь из интервала `1 <= M < 2`)

- **машинный порядок** `P` - целое число, означающее степень двойки,
на которую следует умножить мантиссу.

- `s` - отдельный бит под знак числа (`1` - отрицательное число, `0` - положительное)

Итоговое число:

```text
N = (-1)^s * M * 2^p
```

В восьмибайтном числе с плавающей точкой:

- первый 1 бит - знак
- следующие 11 бит - порядок (смещение порядка 1023)
- остальные 52 бита - мантисса

Чтобы сложить/вычесть 2 числа с плавающей запятой их нужно:

- *Привести к одному порядку* - у числа с меньшим порядком сдвинуть вправо мантису

- Сложение/вычитание чисел

- Если результат `< 1` или `>= 2`, то его *нормализуют* - изменяют порядок и сдвигают мантиссу, чтобы значение числа не изменилось, но мантисса снова стала
равна `1 <= M < 2`

Аналогичная нормализация проводится при перемножении и делении чисел.

При сдвиге вправо мантисы возникает **ошибка округления** - теряются младшие биты мантиссы.

Поэтому **вычисления над числами с плавающей точкой практически всегда дают не точный результат, а приблизительный**.

Поэтому **нельзя проверять числа с плвающей точкой на строгое равенство**.

## 1.4.4. Тексты и языки (кратко)

**Алгоритмически полный язык** или **Тьюринг-полный язык** - язык, на котором можно записать любой алгоритм. Или, более точно, это язык, на котором можно написать интерпретатор (симулятор/модель) машины Тьюринга.

## 1.4.5. Текст как формат данных. Кодировки

**В ряде случаев использование символов, не вошедших в набор ASCII считается нежелательным или вообще запрещается**.

(Например, для текстов компьютерных программ).

### Основные свойства текстового представления данных

- любой фрагмент текста является текстом
- объединение нескольких символов является текстом
- представление любого символа занимает ровно 1 байт
- 1 байт позволяет извлечь любой символ по его номеру, не просматривая весь текст
- представление текста не зависит от архитектуры компьютера
- данные в текстовом формате могут быть прочитаны человеком на любом компьютере

### ASCII

*ASCII - American Standard Code for Information Interchange*

ASCII-text или plain text.

7 битная кодировка - 128 кодов

- управляющие коды (с 0 до 31)
  - табуляция (9)
  - перевод строки (10)
  - возврат каретки (13)

- пробел (32)

- знаки препинания и математические символы (с 33 по 47)

- 10 арабских цифр (с 48 до 57)

- 26 заглавных латинских букв (с 65 по 90)

- 26 строчных латинских букв (с 97 по 122)

- код 126 тильда (`~`)

- код 127 (последний) - управляющий код (RUBOUT) для вычеркивания символа

>В перфолентах было 7 позиций в ширину. 1 - дырка пробита, 0 - нет.
>Пробитие всех 7 отверстий означало 127 код - игнорирование символа (т.е. он вычеркнут).

### КОИ8 (расширение ASCII)

*КОИ8 - Код обмена информацией восьмибитный*

8 битная кодировка, расширение ASCII.

КОИ8 единственная из русских кодировок, которая при отбрасывании старшего 8-го
бита позволяет прочитать текст по латински.

Пример. "добрый день" при отрасывании 8 бита превратиться в "DOBRYJ DENX".

### Другие расширения ASCII

- `cp866` - эпоха MS-DOS
- `cp1251` - из Windows
- `MacCyrillic` - используется на Apple Macintosh

### Unicode

Unicode - универсальное множество символов (реестр известных символов,
universal character set, UCS).

В Unicode определено больше 110 000 символов.

Кодировки на основе Unicode:

- `UCS-2`
- `UCS-4` или `UTF-32`
- `UTF-8`
- `UTF-16`

`UCS-2`. 2 байта на символ.
Устаревшая кодировка.
Всего 65536 символов - не хватает для хранения всех символов.

`UCS-4`. 4 байта на символ. Не используется из-за большого расхода памяти.

`UTF-16`. 2 байта на символ. Нет никаких достоинств.

Недостатки кодировок `UCS-2`, `UCS-4` и `UTF-16`:

- Зависят от порядка байтов в представлении целых чисел.
- Первые 2 или 4 байта в файле - это псевдосимвол `FEFF`.
- Объединение текстов уже не обязательно представляет собой текст.

### Unicode. UTF-8

127 кодов совпадают с ASCII.

Для хранения символа может также использоваться 2, 3, 4 байта.

Если байт начинается с битов

- `110` - символ представлен 2 байтами
- `1110` - символ представлен 3 байтами
- `11110` - символ представлен 4 байтами

Дополнительные байты начинаются с битов `10`.

Плюсы UTF-8:

- Текст не зависит от порядка байтов в целых числах
- Фрагмент текста остается корректным
- Объединение текстов в UTF-8 остается текстом UTF-8

Недостаток UTF-8:

- Для извлечения текста по его номеру надо просмотреть весь предшествующий
ему текст.

## 1.4.6. Бинарные и текстовые данные (кратко)

Утилита `hexdump` - display file contents in hexadecimal, decimal, octal, or ascii.

Ключ `-C` - Canonical hex+ASCII display. Вывести значения байтов вместе с
соответствующими этим байтам ASCII символы. Если символ нельзя отобразить
на экране, то выводится `.`.

В примерах книги - вывод на печать в консоли файлов:

- текстового файла [`numbers.txt`](/src/ch01/numbers.txt)
- бинарного файла [`numbers.bin`](/src/ch01/numbers.bin)

Вывод на экран при помощи `cat` и `hexdump -C`.

## 1.4.7. Машинный код, компиляторы и интерпретаторы

Компьютер состоит из:

- Центрального процессора
- Оперативной памяти
- Периферийных устройств

В большинстве случаев все компоненты подключаются к *общей шине*.

Оперативная память состоит из одинаковых *ячеек памяти*, каждая из которых
имеет свой уникальный номер - *адрес*.
Ячейка содержит несколько (чаще всего 8) двоичных разрядов - возможных состояний ячейки 256.

В процессоре есть *регистры* - используются для хранения самой необходимой
информации.

Количество информации, которое процессор может обработать в один прием
(за одну команду), называется *машинным словом*.
Размер большиства регистров равн машинному слову.
В Pentium машинное слово = 32 бита или 4 восьмибитовые ячейки памяти.

Программа записывается в оперативную память в виде цифровых кодов.
Специальный регистр процессора - *счетчик команд* или *указатель инструкции*
определяет из какого места памяти надо взять код очередной команды.

Процессор выполняет *цикл обработки команд*:

1) извлекает из памяти код очередной команды
2) увеличивает счетчик команд
3) дешифрует извлеченный код
4) исполняет предписанные действия
1) извлекает из памяти код очередной команды
...

Преставление программы, состоящее из кодов машинных команд и "понятное"
процессору называется *машинным кодом*.

**Компилятор** - программа, которая принимает на вход текст программы, а на
выход выдает эквивалентный машинный код.

Текст программы - *исходный текст*.

**Интерпретация** - способ исполнения программ путем загрузки исходного
текста программы и выполнения его шаг за шагом.

Интерпретаторы с целью повышения быстродействия могут переводить программу
в промежуточное представление, которое затем сами выполняют.

**Интерпретатор во время исполнения инетрпретируемой программы вынужден сам находиться в памяти**. Тогда как компилятор нужен лишь на этапе компиляции,
а исполняться программа может без его участия.

### Ассемблер

Ассемблер - частный случай компилятора. Это программа, которая принимает
на вход текст, содержащий условные обозначения машинных команд, удобные для
человека, на выходе - переводит их в коды машинных команд, понятных процессору.

Условные обозначения команд - *мнемоники*.

Язык таких условных обозначений (мнемоник) - *язык ассемблера*.

Для одного процессора может существовать несколько разных ассемблеров.

Ассемблер точно транслирует мнемоники в машинные программы.
Компилятор же может переставлять машинные команды с целью оптимизации быстродействия.
